# SpringCloud理论学习
## SpringCloud 五大组件

- 服务注册与发现——Netflix Eureka

- 负载均衡：
  - 客户端负载均衡——Netflix Ribbon
  - 服务端负载均衡：——Feign(其也是依赖于Ribbon，只是将用方式RestTemplete 更改成Service 接口)
- 断路器——Netflix Hystrix

- 服务网关——Netflix Zuul

- 分布式配置——Spring Cloud Config

## 常见面试题
1.  什么是微服务？

2. 微服务之间是如何独立通讯的？

3. SpringCloud 和 Dubbo有那些区别？

4. SpringBoot 和 SpringCloud，请谈谈你对他们的理解

5. 什么是服务熔断？什么是服务降级？

6. 微服务的优缺点分别是什么？说下你在项目开发中遇到的坑

7. 你所知道的微服务技术栈有哪些？列举一二

8. Eureka和Zookeeper都可以提供服务注册与发现的功能，请说说两者的区别

## 微服务概述

> 什么是微服务？

微服务(Microservice Architecture) 是近几年流行的一种架构思想，关于它的概念很难一言以蔽之。

究竟什么是微服务呢？我们在此引用ThoughtWorks 公司的首席科学家 Martin Fowler 于2014年提出的一段话：

原文：https://martinfowler.com/articles/microservices.html

汉化：https://www.cnblogs.com/liuning8023/p/4493156.html

- 就目前而言，对于微服务，业界并没有一个统一的，标准的定义。
- 但通常而言，微服务架构是一种架构模式，或者说是一种架构风格，它体长将单一的应用程序划分成一组小的服务，每个服务运行在其独立的自己的进程内，服务之间互相协调，互相配置，为用户提供最终价值，服务之间采用轻量级的通信机制(HTTP)互相沟通，每个服务都围绕着具体的业务进行构建，并且能狗被独立的部署到生产环境中，另外，应尽量避免统一的，集中式的服务管理机制，对具体的一个服务而言，应该根据业务上下文，选择合适的语言，工具(Maven)对其进行构建，可以有一个非常轻量级的集中式管理来协调这些服务，可以使用不同的语言来编写服务，也可以使用不同的数据存储。

> 再来从技术维度角度理解下：

- 微服务化的核心就是将传统的一站式应用，根据业务拆分成一个一个的服务，彻底地去耦合，每一个微服务提供单个业务功能的服务，一个服务做一件事情，从技术角度看就是一种小而独立的处理过程，类似进程的概念，能够自行单独启动或销毁，拥有自己独立的数据库。


## 微服务与微服务架构
> 微服务

强调的是服务的大小，它关注的是某一个点，是具体解决某一个问题/提供落地对应服务的一个服务应用，狭义的看，可以看作是IDEA中的一个个微服务工程，或者Moudel。IDEA 工具里面使用Maven开发的一个个独立的小Moudel，它具体是使用SpringBoot开发的一个小模块，专业的事情交给专业的模块来做，一个模块就做着一件事情。强调的是一个个的个体，每个个体完成一个具体的任务或者功能。

> 微服务架构

一种新的架构形式，Martin Fowler 于2014年提出。

微服务架构是一种架构模式，它体长将单一应用程序划分成一组小的服务，服务之间相互协调，互相配合，为用户提供最终价值。每个服务运行在其独立的进程中，服务与服务之间采用轻量级的通信机制
==(如HTTP)互相协作，每个服务都围绕着具体的业务进行构建，并且能够被独立的部署到生产环境中，另外，应尽量避免统一的，集中式的服务管理机制，对具体的一个服务而言，应根据业务上下文，选择合适的语言、工具(如Maven)==
对其进行构建。


## 微服务优缺点

> 优点

- 单一职责原则；

- 每个服务足够内聚，足够小，代码容易理解，这样能聚焦一个指定的业务功能或业务需求；

- 开发简单，开发效率高，一个服务可能就是专一的只干一件事；

- 微服务能够被小团队单独开发，这个团队只需2-5个开发人员组成；

- 微服务是松耦合的，是有功能意义的服务，无论是在开发阶段或部署阶段都是独立的；

- 微服务能使用不同的语言开发；

- 易于和第三方集成，微服务允许容易且灵活的方式集成自动部署，通过持续集成工具，如jenkins，Hudson，bamboo；

- 微服务易于被一个开发人员理解，修改和维护，这样小团队能够更关注自己的工作成果，无需通过合作才能体现价值；

- 微服务允许利用和融合最新技术；

- 微服务只是业务逻辑的代码，不会和HTML，CSS，或其他的界面混合;

- 每个微服务都有自己的存储能力，可以有自己的数据库，也可以有统一的数据库；

> 缺点

- 开发人员要处理分布式系统的复杂性；
- 多服务运维难度，随着服务的增加，运维的压力也在增大；
- 系统部署依赖问题；
- 服务间通信成本问题；
- 数据一致性问题；
- 系统集成测试问题；
- 性能和监控问题；

## 微服务技术栈有那些？


微服务技术条目 | 	落地技术
---|---
服务开发  |	 SpringBoot、Spring、SpringMVC等
服务配置与管理	| Netfix公司的Archaius、阿里的Diamond等
服务注册与发现 |	Eureka、Consul、Zookeeper等
服务调用 |	Rest、PRC、gRPC
服务熔断器 | 	Hystrix、Envoy等
负载均衡 |	Ribbon、Nginx等
服务接口调用(客户端调用服务的简化工具) |	Fegin等
消息队列 |	 Kafka、RabbitMQ、ActiveMQ等
服务配置中心管理  |	 SpringCloudConfig、Chef等
服务路由(API网关)  |	Zuul等
服务监控  |	Zabbix、Nagios、Metrics、Specatator等
全链路追踪  |	Zipkin、Brave、Dapper等
数据流操作开发包  |	SpringCloud Stream(封装与Redis，Rabbit，Kafka等发送接收消息)
时间消息总栈 |	SpringCloud Bus
服务部署  |	 Docker、OpenStack、Kubernetes等



## 为什么选择SpringCloud作为微服务架构

1. 选型依据

- 整体解决方案和框架成熟度

- 社区热度

- 可维护性

- 学习曲线

2. 当前各大IT公司用的微服务架构有那些？

- 阿里：dubbo+HFS

- 京东：JFS

- 新浪：Motan

- 当当网：DubboX

 - …

3. 各微服务框架对比

功能点/服务框架	 | Netflix/SpringCloud	| Motan | gRPC	| Thri t	|  Dubbo/DubboX
---|---|---|---|---|---
功能定位 |	完整的微服务框架 |	 RPC框架，但整合了ZK或Consul，实现集群环境的基本服务注册发现 |	RPC框架 |	RPC框架 |	服务框架
支持Rest |	是，Ribbon支持多种可拔插的序列号选择	| 否	| 否	| 否	| 否
支持RPC	| 否	| 是(Hession2) |	是 |	是	| 是
支持多语言 |	是(Rest形式) |	否	| 是 |	是 |	否
负载均衡 |	是(服务端zuul+客户端Ribbon)，zuul-服务，动态路由，云端负载均衡Eureka（针对中间层服务器） |	是(客户端) |	否	| 否 |	是(客户端)
配置服务 |	Netfix Archaius，Spring Cloud Config Server 集中配置 |	是(Zookeeper提供)	| 否	| 否 |	否
服务调用链监控 |	是(zuul)，zuul提供边缘服务，API网关 |	否	| 否	| 否 |	否
高可用/容错	| 是(服务端Hystrix+客户端Ribbon) |	是(客户端) |	否 |	否 |	是(客户端)
典型应用案例 |	Netflix |	Sina	| Google |	Facebook	
社区活跃程度 |	高 |	一般 |	高 |	一般	2017年后重新开始维护，之前中断了5年
学习难度 |中等 |	低 |	高 |	高 |	低
文档丰富程度 |	高 |	一般 |	一般 |	一般 |	高
其他 | Spring Cloud Bus为我们的应用程序带来了更多管理端点 | 支持降级	|   Netflix内部在开发集成gRPC |	IDL定义 |	实践的公司比较多


